function centerMarkerOnMap(myMap,marker){myMap.flyTo(marker.getLatLng(),12)}
function createAMarker(markerGroup,dataJSON,myMap){var greenIcon=L.icon({iconUrl:"./assets/ip-address-images/icon-location.svg",iconSize:[32,32],iconAnchor:[16,32],}),marker=L.marker([dataJSON.location.lat,dataJSON.location.lng],{icon:greenIcon,}).addTo(markerGroup);centerMarkerOnMap(myMap,marker),addMarkerEvents(marker)}
function addMarkerEvents(marker){marker.on("mouseover",()=>{marker.bindPopup("lat: "+marker.getLatLng().lat+", long: "+marker.getLatLng().lng,)})}
function isAnIP(ipOrDomain){var ipOrDomainParts=[];ipOrDomainParts=ipOrDomain.split(".");for(var i=0,allDigits=!0;allDigits&&i<ipOrDomainParts.length;)(digits=parseInt(ipOrDomainParts[i])),digits?i++:(allDigits=!1);return allDigits}
function convertNullToSpace(json){return json?" "+json:""}
function getInformation(ipOrDomain,markerGroup,myMap){var ip="",dmn="",dataAJAX={},api_key="at_QZpkwR24mhkobNpbPI4XrCtOvWthK";ajaxFunction((dataAJAX=""==ipOrDomain?{apiKey:api_key}:isAnIP(ipOrDomain)?{apiKey:api_key,ipAddress:(ip=ipOrDomain)}:{apiKey:api_key,domain:(dmn=ipOrDomain)}),markerGroup,myMap,)}
function ajaxFunction(dataAJAX,markerGroup,myMap){$.ajax({url:"https://geo.ipify.org/api/v2/country,city,vpn?",data:dataAJAX,success:function(dataJSON){displayData(dataJSON,markerGroup,myMap)},error:(jqXHR,textStatus,error)=>alert("IP address or domain wasn't recognized"),})}
function displayData(dataJSON,markerGroup,myMap){(document.getElementById("ip").innerText=dataJSON.ip),(document.getElementById("location").innerText=dataJSON.location.country+", "+dataJSON.location.region+convertNullToSpace(dataJSON.location.city)+convertNullToSpace(dataJSON.location.postalCode)),(document.getElementById("timezone").innerText="UTC-"+dataJSON.location.timezone),(document.getElementById("isp").innerText=dataJSON.isp),createAMarker(markerGroup,dataJSON,myMap)}
$(document).ready(function(){var myMap=L.map("map",{zoomControl:!1,minZoom:3}).setView([52.8067,-2.1207],9,);L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoiY25vcmYiLCJhIjoiY2t3M254MzRnMGN5ajJ4cHh3eWRyNjNsNyJ9.Juf1sSTeP4kgSornOTVC9Q",},).addTo(myMap),L.control.zoom({position:"bottomright"}).addTo(myMap);var markerGroup=L.layerGroup().addTo(myMap),searchField=document.getElementById("search"),searchButton=document.getElementById("submit");searchButton.addEventListener("click",(event)=>{event.preventDefault(),markerGroup.clearLayers(),getPermission(markerGroup,myMap,searchField.value)});if(window.top==window.self){getPermission(markerGroup,myMap,"")}});function getPermission(markerGroup,myMap,ipOrDomain){if(""==ipOrDomain){let text;confirm("Permission to retrieve IP address")&&getInformation(ipOrDomain,markerGroup,myMap)}else getInformation(ipOrDomain,markerGroup,myMap)}